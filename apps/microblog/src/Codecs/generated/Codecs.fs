// AUTO-GENERATED by src/Gen/Program.fs -- do not edit by hand.
module Codecs

open Thoth.Json
open Hedge.Interface
open Hedge.Codec
open Models.Domain
open Models.Api

/// Unwrap helpers â€” terse pattern matches used in Handlers.fs.
let inline pk (PrimaryKey v) = v
let inline ct (CreateTimestamp v) = v
let inline ut (UpdateTimestamp v) = v
let inline sd (SoftDelete v) = v
let inline fk (ForeignKey v) = v
let inline rc (RichContent v) = v
let inline lk (Link v) = v

module Encode =

    // -- Domain types --
    let inline guest (v: Guest) = encode v
    let inline microblogItem (v: MicroblogItem) = encode v
    let inline itemComment (v: ItemComment) = encode v
    let inline tag (v: Tag) = encode v
    let inline itemTag (v: ItemTag) = encode v
    let inline guestSession (v: GuestSession) = encode v

    // -- API view types --
    let inline microblogItemView (v: SubmitItem.MicroblogItem) = encode v
    let inline commentItem (v: SubmitComment.CommentItem) = encode v
    let inline feedItem (v: GetFeed.FeedItem) = encode v

    // -- API request encoders --
    let inline submitItemReq (v: SubmitItem.Request) = encode v
    let inline submitCommentReq (v: SubmitComment.Request) = encode v

    // -- WebSocket event encoders --
    let inline newCommentEvent (e: Models.Ws.NewCommentEvent) = encode e
    let inline commentModeratedEvent (e: Models.Ws.CommentModeratedEvent) = encode e
    let inline commentRemovedEvent (e: Models.Ws.CommentRemovedEvent) = encode e

module Decode =

    // -- Domain types --
    let guest : Decoder<Guest> = decode<Guest>()
    let microblogItem : Decoder<MicroblogItem> = decode<MicroblogItem>()
    let itemComment : Decoder<ItemComment> = decode<ItemComment>()
    let tag : Decoder<Tag> = decode<Tag>()
    let itemTag : Decoder<ItemTag> = decode<ItemTag>()
    let guestSession : Decoder<GuestSession> = decode<GuestSession>()

    // -- API view types --
    let microblogItemView : Decoder<SubmitItem.MicroblogItem> = decode<SubmitItem.MicroblogItem>()
    let commentItem : Decoder<SubmitComment.CommentItem> = decode<SubmitComment.CommentItem>()
    let feedItem : Decoder<GetFeed.FeedItem> = decode<GetFeed.FeedItem>()

    // -- API response decoders --
    let getItemsByTagResponse : Decoder<GetItemsByTag.Response> = decode<GetItemsByTag.Response>()
    let getTagsResponse : Decoder<GetTags.Response> = decode<GetTags.Response>()
    let getItemResponse : Decoder<GetItem.Response> = decode<GetItem.Response>()
    let submitItemResponse : Decoder<SubmitItem.Response> = decode<SubmitItem.Response>()
    let submitCommentResponse : Decoder<SubmitComment.Response> = decode<SubmitComment.Response>()
    let getFeedResponse : Decoder<GetFeed.Response> = decode<GetFeed.Response>()

    // -- API request decoders --
    let submitItemReq : Decoder<SubmitItem.Request> = decode<SubmitItem.Request>()
    let submitCommentReq : Decoder<SubmitComment.Request> = decode<SubmitComment.Request>()

    // -- WebSocket event decoders --
    let newCommentEvent : Decoder<Models.Ws.NewCommentEvent> = decode<Models.Ws.NewCommentEvent>()
    let commentModeratedEvent : Decoder<Models.Ws.CommentModeratedEvent> = decode<Models.Ws.CommentModeratedEvent>()
    let commentRemovedEvent : Decoder<Models.Ws.CommentRemovedEvent> = decode<Models.Ws.CommentRemovedEvent>()

module Validate =

    open Hedge.Schema
    open Hedge.Validate

    let submitItemSchema =
        schema "SubmitItem.Request" [
            fieldWith "Title" FString [Required; Trim]
            fieldWith "Link" (FOption FString) [Trim]
            fieldWith "Image" (FOption FString) [Trim]
            fieldWith "Extract" (FOption FString) [Trim]
            fieldWith "OwnerComment" FString [Required; Trim]
            fieldWith "Tags" (FList FString) []
        ]

    let inline submitItemReq (r: SubmitItem.Request) = validate submitItemSchema r

    let submitCommentSchema =
        schema "SubmitComment.Request" [
            fieldWith "ItemId" FString [Required; Trim]
            fieldWith "ParentId" (FOption FString) [Trim]
            fieldWith "Content" FString [Required; Trim]
            fieldWith "Author" (FOption FString) [Trim]
        ]

    let inline submitCommentReq (r: SubmitComment.Request) = validate submitCommentSchema r
