// AUTO-GENERATED by src/Gen/Program.fs -- do not edit by hand.
module Client.ClientGen

open Fable.Core
open Thoth.Json
open Models.Api
open Models.Ws
open Codecs
open Client.Api

// --- HTTP API ---

let getItemsByTag (id: string) =
    fetchJson (sprintf "/api/tags/%s/items" id) Decode.getItemsByTagResponse

let getTags () =
    fetchJson "/api/tags" Decode.getTagsResponse

let getItem (id: string) =
    fetchJson (sprintf "/api/item/%s" id) Decode.getItemResponse

let submitItem (req: SubmitItem.Request) =
    let body = Encode.submitItemReq req |> Encode.toString 0
    postJson "/api/item" body Decode.submitItemResponse

let submitComment (req: SubmitComment.Request) =
    let body = Encode.submitCommentReq req |> Encode.toString 0
    postJson "/api/comment" body Decode.submitCommentResponse

let getFeed () =
    fetchJson "/api/feed" Decode.getFeedResponse

// --- WebSocket Events ---

type WsEvent =
    | NewComment of NewCommentEvent
    | CommentModerated of CommentModeratedEvent
    | CommentRemoved of CommentRemovedEvent

let decodeWsEvent (text: string) : Result<WsEvent, string> =
    match Decode.fromString (Decode.field "type" Decode.string) text with
    | Ok "NewComment" ->
        Decode.fromString (Decode.field "payload" Decode.newCommentEvent) text
        |> Result.map NewComment
    | Ok "CommentModerated" ->
        Decode.fromString (Decode.field "payload" Decode.commentModeratedEvent) text
        |> Result.map CommentModerated
    | Ok "CommentRemoved" ->
        Decode.fromString (Decode.field "payload" Decode.commentRemovedEvent) text
        |> Result.map CommentRemoved
    | Ok t -> Error (sprintf "Unknown event: %s" t)
    | Error e -> Error e
